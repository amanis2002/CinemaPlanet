var ua = window.navigator.userAgent;
var msie = ua.indexOf("MSIE ");
var isMobile = { Android: function () { return navigator.userAgent.match(/Android/i); }, BlackBerry: function () { return navigator.userAgent.match(/BlackBerry/i); }, iOS: function () { return navigator.userAgent.match(/iPhone|iPad|iPod/i); }, Opera: function () { return navigator.userAgent.match(/Opera Mini/i); }, Windows: function () { return navigator.userAgent.match(/IEMobile/i); }, any: function () { return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows()); } };
function isIE() {
	ua = navigator.userAgent;
	var is_ie = ua.indexOf("MSIE ") > -1 || ua.indexOf("Trident/") > -1;
	return is_ie;
}
if (isIE()) {
	document.querySelector('html').classList.add('ie');
}
if (isMobile.any()) {
	document.querySelector('html').classList.add('_touch');
}


function ibg() {
	if (isIE()) {
		let ibg = document.querySelectorAll("._ibg");
		for (var i = 0; i < ibg.length; i++) {
			if (ibg[i].querySelector('img') && ibg[i].querySelector('img').getAttribute('src') != null) {
				ibg[i].style.backgroundImage = 'url(' + ibg[i].querySelector('img').getAttribute('src') + ')';
			}
		}
	}
}
ibg();

window.addEventListener("load", function () {
	if (document.querySelector('.wrapper')) {
		setTimeout(function () {
			document.querySelector('.wrapper').classList.add('_loaded');
		}, 0);
	}
});

let unlock = true;

function menu_close() {
	let iconMenu = document.querySelector(".header-icon");
	let menuBody = document.querySelector(".header-center");
	iconMenu.classList.remove("_active");
	menuBody.classList.remove("_active");
}

document.addEventListener('keyup', function (event) {
	if (event.code === 'Escape') {
		menu_close();
		console.log("Close");
	}
});
//=================
//BodyLock
function body_lock(delay) {
	let body = document.querySelector("body");
	if (body.classList.contains('_lock')) {
		body_lock_remove(delay);
	} else {
		body_lock_add(delay);
	}
}
function body_lock_remove(delay) {
	let body = document.querySelector("body");
	if (unlock) {
		let lock_padding = document.querySelectorAll("._lp");
		setTimeout(() => {
			for (let index = 0; index < lock_padding.length; index++) {
				const el = lock_padding[index];
				el.style.paddingRight = '0px';
			}
			body.style.paddingRight = '0px';
			body.classList.remove("_lock");
		}, delay);

		unlock = false;
		setTimeout(function () {
			unlock = true;
		}, delay);
	}
}
function body_lock_add(delay) {
	let body = document.querySelector("body");
	if (unlock) {
		let lock_padding = document.querySelectorAll("._lp");
		for (let index = 0; index < lock_padding.length; index++) {
			const el = lock_padding[index];
			el.style.paddingRight = window.innerWidth - document.querySelector('.wrapper').offsetWidth + 'px';
		}
		body.style.paddingRight = window.innerWidth - document.querySelector('.wrapper').offsetWidth + 'px';
		body.classList.add("_lock");

		unlock = false;
		setTimeout(function () {
			unlock = true;
		}, delay);
	}
}

//SlideToggle
let _slideUp = (target, duration = 500) => {
	if (!target.classList.contains('_slide')) {
		target.classList.add('_slide');
		target.style.transitionProperty = 'height, margin, padding';
		target.style.transitionDuration = duration + 'ms';
		target.style.height = target.offsetHeight + 'px';
		target.offsetHeight;
		target.style.overflow = 'hidden';
		target.style.height = 0;
		target.style.paddingTop = 0;
		target.style.paddingBottom = 0;
		target.style.marginTop = 0;
		target.style.marginBottom = 0;
		window.setTimeout(() => {
			target.hidden = true;
			target.style.removeProperty('height');
			target.style.removeProperty('padding-top');
			target.style.removeProperty('padding-bottom');
			target.style.removeProperty('margin-top');
			target.style.removeProperty('margin-bottom');
			target.style.removeProperty('overflow');
			target.style.removeProperty('transition-duration');
			target.style.removeProperty('transition-property');
			target.classList.remove('_slide');
		}, duration);
	}
}
let _slideDown = (target, duration = 500) => {
	if (!target.classList.contains('_slide')) {
		target.classList.add('_slide');
		if (target.hidden) {
			target.hidden = false;
		}
		let height = target.offsetHeight;
		target.style.overflow = 'hidden';
		target.style.height = 0;
		target.style.paddingTop = 0;
		target.style.paddingBottom = 0;
		target.style.marginTop = 0;
		target.style.marginBottom = 0;
		target.offsetHeight;
		target.style.transitionProperty = "height, margin, padding";
		target.style.transitionDuration = duration + 'ms';
		target.style.height = height + 'px';
		target.style.removeProperty('padding-top');
		target.style.removeProperty('padding-bottom');
		target.style.removeProperty('margin-top');
		target.style.removeProperty('margin-bottom');
		window.setTimeout(() => {
			target.style.removeProperty('height');
			target.style.removeProperty('overflow');
			target.style.removeProperty('transition-duration');
			target.style.removeProperty('transition-property');
			target.classList.remove('_slide');
		}, duration);
	}
}
let _slideToggle = (target, duration = 500) => {
	if (target.hidden) {
		return _slideDown(target, duration);
	} else {
		return _slideUp(target, duration);
	}
}
//========================================
//Wrap
function _wrap(el, wrapper) {
	el.parentNode.insertBefore(wrapper, el);
	wrapper.appendChild(el);
}
//========================================
//RemoveClasses
function _removeClasses(el, class_name) {
	for (var i = 0; i < el.length; i++) {
		el[i].classList.remove(class_name);
	}
}
//========================================
//IsHidden
function _is_hidden(el) {
	return (el.offsetParent === null)
}

const menuLinks = document.querySelectorAll('.menu__link')
let linkId = localStorage.getItem('activeId')
if (linkId){
    menuLinks.forEach(menuItem => {
        menuItem.classList.remove('_active')
    })
    let link = document.getElementById(linkId)
    link.classList.add('_active')
}
for (let index = 0; index < menuLinks.length; index++) {
    let menuLink = menuLinks[index]
    menuLink.addEventListener("click", function (e) {
        localStorage.setItem('activeId', menuLink.id)
    })
}





const tabButtons = document.querySelectorAll('.schedule-tabs__item')
const tabBlocks = document.querySelectorAll('.schedule-tabs__block')
tabButtons.forEach(tabButton => {
    tabButton.addEventListener("click", function (e) {
        let tabId = tabButton.getAttribute("data-tab")
        let currentTab = document.querySelector(tabId)
        if (!tabButton.classList.contains('_active')){
            tabButtons.forEach(tabButton => {
                tabButton.classList.remove("_active") 
            }),
            tabBlocks.forEach(tabBlock => {
                tabBlock.classList.remove("_active") 
            }),
            tabButton.classList.add("_active")
            currentTab.classList.add("_active")
        }

    });
})

const movieTabButtons = document.querySelectorAll('.movies-tabs__item')
const movieTabBlocks = document.querySelectorAll('.movies-tabs__block')
movieTabButtons.forEach(tabButton => {
    tabButton.addEventListener("click", function (e) {
        let tabId = tabButton.getAttribute("data-tab")
        let currentTab = document.querySelector(tabId)
        if (!tabButton.classList.contains('_active')){
            movieTabButtons.forEach(tabButton => {
                tabButton.classList.remove("_active") 
            }),
            movieTabBlocks.forEach(tabBlock => {
                tabBlock.classList.remove("_active") 
            }),
            tabButton.classList.add("_active")
            currentTab.classList.add("_active")
        }

    });
})

let iconMenu = document.querySelector(".icon-menu");
if (iconMenu != null) {
	let delay = 500;
	let menuBody = document.querySelector(".header__menu");
	iconMenu.addEventListener("click", function (e) {
		if (unlock) {
			body_lock(delay);
			iconMenu.classList.toggle("_active");
			menuBody.classList.toggle("_active");
		}
	});
};

window.addEventListener("scroll", head_scroll)
function head_scroll() {
    let header = document.querySelector('.header')
    let scrollPx = pageYOffset;
    if(scrollPx > 300){
        header.classList.add('_scroll')
    }
    else{
        header.classList.remove('_scroll')
    }
}
let sliders = document.querySelectorAll("._swiper");
if (sliders) {
  for (let index = 0; index < sliders.length; index++) {
    let slider = sliders[index];
    if (!slider.classList.contains("swiper-bild")) {
      let slider_items = slider.children;
      if (slider_items) {
        for (let index = 0; index < slider_items.length; index++) {
          let el = slider_items[index];
          el.classList.add("swiper-slide");
        }
      }
      let slider_content = slider.innerHTML;
      let slider_wrapper = document.createElement("div");
      slider_wrapper.classList.add("swiper-wrapper");
      slider_wrapper.innerHTML = slider_content;
      slider.innerHTML = "";
      slider.appendChild(slider_wrapper);
      slider.classList.add("swiper-bild");
    }
    if (slider.classList.contains("_gallery")) {
      //slider.data('lightGallery').destroy(true);
    }
  }
  sliders_bild_callback();
}

function sliders_bild_callback(params) {}

if (document.querySelector(".main-slider")) {
  let mainslider = new Swiper(".main-slider__body", {
    observer: true,
    observeParents: true,
    slidesPerView: 1,
    spaceBetween: 0,
    autoHeight: true,
    speed: 800,

    //loop: true,
    //preloadImages: false,
    //lazy: true,
    // Dotts
    pagination: {
      el: ".main-slider__dotts",
      clickable: true,
    },
    // breakpoints: {
    // 	320: {
    // 		slidesPerView: 1,
    // 		spaceBetween: 0,
    // 		autoHeight: true,
    // 	},
    // 	768: {
    // 		slidesPerView: 2,
    // 		spaceBetween: 20,
    // 	},
    // 	992: {
    // 		slidesPerView: 3,
    // 		spaceBetween: 20,
    // 	},
    // 	1268: {
    // 		slidesPerView: 4,
    // 		spaceBetween: 30,
    // 	},
    // },
    on: {
      lazyImageReady: function () {
        ibg();
      },
    },
  });
}

if (document.querySelector(".comming-soon__body")) {
  let mainslider = new Swiper(".upcoming-slider__container", {
    observer: true,
    observeParents: true,
    slidesPerView: 1,
    spaceBetween: 0,
    autoHeight: true,
    speed: 500,
    effect: "fade",
    fadeEffect: {
      crossFade: true,
    },
    on: {
      lazyImageReady: function () {
        ibg();
      },
    },
    thumbs: {
      swiper: {
        el: ".upcoming-mini-slider__container",
        slidesPerView: 6,
        speed: 500,
        spaceBetween: 30,
        loop: true,
        navigation: {
          nextEl: ".swiper-button-next",
          prevEl: ".swiper-button-prev",
        },
        breakpoints: {
          320: {
            slidesPerView: 1,
            spaceBetween: 10,
            autoHeight: true,
          },
		  400: {
            slidesPerView: 2,
            spaceBetween: 15,
          },
          600: {
            slidesPerView: 3,
            spaceBetween: 20,
          },
          992: {
            slidesPerView: 5,
          },
          1342: {
            slidesPerView: 6,
            spaceBetween: 30,
          },
        },
      },
    },
  });
}
